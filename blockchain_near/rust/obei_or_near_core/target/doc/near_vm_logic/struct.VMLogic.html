<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `VMLogic` struct in crate `near_vm_logic`."><meta name="keywords" content="rust, rustlang, rust-lang, VMLogic"><title>VMLogic in near_vm_logic - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../favicon.svg">
<link rel="alternate icon" type="image/png" href="../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc struct"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../near_vm_logic/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><h2 class="location">Struct VMLogic</h2><div class="sidebar-elems"><div class="block items"><h3 class="sidebar-title"><a href="#implementations">Methods</a></h3><div class="sidebar-links"><a href="#method.abort">abort</a><a href="#method.account_balance">account_balance</a><a href="#method.account_locked_balance">account_locked_balance</a><a href="#method.add_contract_compile_fee">add_contract_compile_fee</a><a href="#method.attached_deposit">attached_deposit</a><a href="#method.block_index">block_index</a><a href="#method.block_timestamp">block_timestamp</a><a href="#method.clone_outcome">clone_outcome</a><a href="#method.current_account_id">current_account_id</a><a href="#method.epoch_height">epoch_height</a><a href="#method.gas">gas</a><a href="#method.input">input</a><a href="#method.keccak256">keccak256</a><a href="#method.keccak512">keccak512</a><a href="#method.log_utf16">log_utf16</a><a href="#method.log_utf8">log_utf8</a><a href="#method.new">new</a><a href="#method.new_with_protocol_version">new_with_protocol_version</a><a href="#method.outcome">outcome</a><a href="#method.panic">panic</a><a href="#method.panic_utf8">panic_utf8</a><a href="#method.predecessor_account_id">predecessor_account_id</a><a href="#method.prepaid_gas">prepaid_gas</a><a href="#method.promise_and">promise_and</a><a href="#method.promise_batch_action_add_key_with_full_access">promise_batch_action_add_key_with_full_access</a><a href="#method.promise_batch_action_add_key_with_function_call">promise_batch_action_add_key_with_function_call</a><a href="#method.promise_batch_action_create_account">promise_batch_action_create_account</a><a href="#method.promise_batch_action_delete_account">promise_batch_action_delete_account</a><a href="#method.promise_batch_action_delete_key">promise_batch_action_delete_key</a><a href="#method.promise_batch_action_deploy_contract">promise_batch_action_deploy_contract</a><a href="#method.promise_batch_action_function_call">promise_batch_action_function_call</a><a href="#method.promise_batch_action_stake">promise_batch_action_stake</a><a href="#method.promise_batch_action_transfer">promise_batch_action_transfer</a><a href="#method.promise_batch_create">promise_batch_create</a><a href="#method.promise_batch_then">promise_batch_then</a><a href="#method.promise_create">promise_create</a><a href="#method.promise_result">promise_result</a><a href="#method.promise_results_count">promise_results_count</a><a href="#method.promise_return">promise_return</a><a href="#method.promise_then">promise_then</a><a href="#method.random_seed">random_seed</a><a href="#method.read_register">read_register</a><a href="#method.register_len">register_len</a><a href="#method.sha256">sha256</a><a href="#method.signer_account_id">signer_account_id</a><a href="#method.signer_account_pk">signer_account_pk</a><a href="#method.storage_has_key">storage_has_key</a><a href="#method.storage_iter_next">storage_iter_next</a><a href="#method.storage_iter_prefix">storage_iter_prefix</a><a href="#method.storage_iter_range">storage_iter_range</a><a href="#method.storage_read">storage_read</a><a href="#method.storage_remove">storage_remove</a><a href="#method.storage_usage">storage_usage</a><a href="#method.storage_write">storage_write</a><a href="#method.used_gas">used_gas</a><a href="#method.validator_stake">validator_stake</a><a href="#method.validator_total_stake">validator_total_stake</a><a href="#method.value_return">value_return</a><a href="#method.wrapped_internal_write_register">wrapped_internal_write_register</a><a href="#method.write_register">write_register</a></div><h3 class="sidebar-title"><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><div class="sidebar-links"><a href="#impl-RefUnwindSafe">!RefUnwindSafe</a><a href="#impl-Send">!Send</a><a href="#impl-Sync">!Sync</a><a href="#impl-Unpin">Unpin</a><a href="#impl-UnwindSafe">!UnwindSafe</a></div><h3 class="sidebar-title"><a href="#blanket-implementations">Blanket Implementations</a></h3><div class="sidebar-links"><a href="#impl-Any">Any</a><a href="#impl-Borrow%3CT%3E">Borrow&lt;T&gt;</a><a href="#impl-BorrowMut%3CT%3E">BorrowMut&lt;T&gt;</a><a href="#impl-From%3CT%3E">From&lt;T&gt;</a><a href="#impl-Into%3CU%3E">Into&lt;U&gt;</a><a href="#impl-Same%3CT%3E">Same&lt;T&gt;</a><a href="#impl-TryFrom%3CU%3E">TryFrom&lt;U&gt;</a><a href="#impl-TryInto%3CU%3E">TryInto&lt;U&gt;</a></div></div><h2 class="location">Other items in<br><a href="index.html">near_vm_logic</a></h2><div id="sidebar-vars" data-name="VMLogic" data-ty="struct" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img src="../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img src="../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Struct <a href="index.html">near_vm_logic</a>::<wbr><a class="struct" href="#">VMLogic</a><button id="copy-path" onclick="copy_path(this)" title="copy path"><img src="../clipboard.svg" width="19" height="18" alt="Copy item import" title="Copy item import to clipboard"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/near_vm_logic/logic.rs.html#27-70" title="goto source code">[src]</a></span></h1><div class="docblock type-decl"><pre class="rust struct">pub struct VMLogic&lt;'a&gt; { /* fields omitted */ }</pre></div><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor"></a></h2><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;'a&gt; <a class="struct" href="struct.VMLogic.html" title="struct near_vm_logic::VMLogic">VMLogic</a>&lt;'a&gt;</h3><a href="#impl" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#102-2421" title="goto source code">[src]</a></div></summary><div class="impl-items"><div id="method.new_with_protocol_version" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.new_with_protocol_version" class="fnname">new_with_protocol_version</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;ext: &amp;'a mut dyn <a class="trait" href="trait.External.html" title="trait near_vm_logic::External">External</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;context: <a class="struct" href="struct.VMContext.html" title="struct near_vm_logic::VMContext">VMContext</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;config: &amp;'a <a class="struct" href="struct.VMConfig.html" title="struct near_vm_logic::VMConfig">VMConfig</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;fees_config: &amp;'a <a class="struct" href="../near_primitives_core/runtime/fees/struct.RuntimeFeesConfig.html" title="struct near_primitives_core::runtime::fees::RuntimeFeesConfig">RuntimeFeesConfig</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_results: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.slice.html">&amp;'a [</a><a class="enum" href="types/enum.PromiseResult.html" title="enum near_vm_logic::types::PromiseResult">PromiseResult</a><a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.slice.html">]</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;memory: &amp;'a mut dyn <a class="trait" href="trait.MemoryLike.html" title="trait near_vm_logic::MemoryLike">MemoryLike</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;profile: <a class="struct" href="profile/struct.ProfileData.html" title="struct near_vm_logic::profile::ProfileData">ProfileData</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;current_protocol_version: <a class="type" href="type.ProtocolVersion.html" title="type near_vm_logic::ProtocolVersion">ProtocolVersion</a><br>) -&gt; Self</h4><a href="#method.new_with_protocol_version" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#103-149" title="goto source code">[src]</a></div><details class="rustdoc-toggle method-toggle" open><summary><div id="method.new" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.new" class="fnname">new</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;ext: &amp;'a mut dyn <a class="trait" href="trait.External.html" title="trait near_vm_logic::External">External</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;context: <a class="struct" href="struct.VMContext.html" title="struct near_vm_logic::VMContext">VMContext</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;config: &amp;'a <a class="struct" href="struct.VMConfig.html" title="struct near_vm_logic::VMConfig">VMConfig</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;fees_config: &amp;'a <a class="struct" href="../near_primitives_core/runtime/fees/struct.RuntimeFeesConfig.html" title="struct near_primitives_core::runtime::fees::RuntimeFeesConfig">RuntimeFeesConfig</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_results: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.slice.html">&amp;'a [</a><a class="enum" href="types/enum.PromiseResult.html" title="enum near_vm_logic::types::PromiseResult">PromiseResult</a><a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.slice.html">]</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;memory: &amp;'a mut dyn <a class="trait" href="trait.MemoryLike.html" title="trait near_vm_logic::MemoryLike">MemoryLike</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;profile: <a class="struct" href="profile/struct.ProfileData.html" title="struct near_vm_logic::profile::ProfileData">ProfileData</a><br>) -&gt; Self</h4><a href="#method.new" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#153-172" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Legacy initialization method that doesn’t pass the protocol version and uses the last
protocol version before the change was introduced.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.wrapped_internal_write_register" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.wrapped_internal_write_register" class="fnname">wrapped_internal_write_register</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;data: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.slice.html">&amp;[</a><a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.slice.html">]</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.wrapped_internal_write_register" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#272-274" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Convenience function for testing.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.read_register" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.read_register" class="fnname">read_register</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.read_register" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#296-300" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Writes the entire content from the register <code>register_id</code> into the memory of the guest starting with <code>ptr</code>.</p>
<h1 id="arguments" class="section-header"><a href="#arguments">Arguments</a></h1>
<ul>
<li><code>register_id</code> – a register id from where to read the data;</li>
<li><code>ptr</code> – location on guest memory where to copy the data.</li>
</ul>
<h1 id="errors" class="section-header"><a href="#errors">Errors</a></h1>
<ul>
<li>If the content extends outside the memory allocated to the guest. In Wasmer, it returns <code>MemoryAccessViolation</code> error message;</li>
<li>If <code>register_id</code> is pointing to unused register returns <code>InvalidRegisterId</code> error message.</li>
</ul>
<h1 id="undefined-behavior" class="section-header"><a href="#undefined-behavior">Undefined Behavior</a></h1>
<p>If the content of register extends outside the preallocated memory on the host side, or the pointer points to a
wrong location this function will overwrite memory that it is not supposed to overwrite causing an undefined behavior.</p>
<h1 id="cost" class="section-header"><a href="#cost">Cost</a></h1>
<p><code>base + read_register_base + read_register_byte * num_bytes + write_memory_base + write_memory_byte * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.register_len" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.register_len" class="fnname">register_len</a>(&amp;mut self, register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.register_len" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#313-316" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Returns the size of the blob stored in the given register.</p>
<ul>
<li>If register is used, then returns the size, which can potentially be zero;</li>
<li>If register is not used, returns <code>u64::MAX</code></li>
</ul>
<h1 id="arguments-1" class="section-header"><a href="#arguments-1">Arguments</a></h1>
<ul>
<li><code>register_id</code> – a register id from where to read the data;</li>
</ul>
<h1 id="cost-1" class="section-header"><a href="#cost-1">Cost</a></h1>
<p><code>base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.write_register" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.write_register" class="fnname">write_register</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;data_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;data_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.write_register" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#331-335" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Copies <code>data</code> from the guest memory into the register. If register is unused will initialize
it. If register has larger capacity than needed for <code>data</code> will not re-allocate it. The
register will lose the pre-existing data if any.</p>
<h1 id="arguments-2" class="section-header"><a href="#arguments-2">Arguments</a></h1>
<ul>
<li><code>register_id</code> – a register id where to write the data;</li>
<li><code>data_len</code> – length of the data in bytes;</li>
<li><code>data_ptr</code> – pointer in the guest memory where to read the data from.</li>
</ul>
<h1 id="cost-2" class="section-header"><a href="#cost-2">Cost</a></h1>
<p><code>base + read_memory_base + read_memory_bytes * num_bytes + write_register_base + write_register_bytes * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.current_account_id" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.current_account_id" class="fnname">current_account_id</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.current_account_id" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#516-523" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Saves the account id of the current contract that we execute into the register.</p>
<h1 id="errors-1" class="section-header"><a href="#errors-1">Errors</a></h1>
<p>If the registers exceed the memory limit returns <code>MemoryAccessViolation</code>.</p>
<h1 id="cost-3" class="section-header"><a href="#cost-3">Cost</a></h1>
<p><code>base + write_register_base + write_register_byte * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.signer_account_id" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.signer_account_id" class="fnname">signer_account_id</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.signer_account_id" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#538-551" title="goto source code">[src]</a></div></summary><div class="docblock"><p>All contract calls are a result of some transaction that was signed by some account using
some access key and submitted into a memory pool (either through the wallet using RPC or by
a node itself). This function returns the id of that account. Saves the bytes of the signer
account id into the register.</p>
<h1 id="errors-2" class="section-header"><a href="#errors-2">Errors</a></h1>
<ul>
<li>If the registers exceed the memory limit returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-4" class="section-header"><a href="#cost-4">Cost</a></h1>
<p><code>base + write_register_base + write_register_byte * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.signer_account_pk" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.signer_account_pk" class="fnname">signer_account_pk</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.signer_account_pk" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#565-575" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Saves the public key fo the access key that was used by the signer into the register. In
rare situations smart contract might want to know the exact access key that was used to send
the original transaction, e.g. to increase the allowance or manipulate with the public key.</p>
<h1 id="errors-3" class="section-header"><a href="#errors-3">Errors</a></h1>
<ul>
<li>If the registers exceed the memory limit returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-5" class="section-header"><a href="#cost-5">Cost</a></h1>
<p><code>base + write_register_base + write_register_byte * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.predecessor_account_id" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.predecessor_account_id" class="fnname">predecessor_account_id</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.predecessor_account_id" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#589-602" title="goto source code">[src]</a></div></summary><div class="docblock"><p>All contract calls are a result of a receipt, this receipt might be created by a transaction
that does function invocation on the contract or another contract as a result of
cross-contract call. Saves the bytes of the predecessor account id into the register.</p>
<h1 id="errors-4" class="section-header"><a href="#errors-4">Errors</a></h1>
<ul>
<li>If the registers exceed the memory limit returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-6" class="section-header"><a href="#cost-6">Cost</a></h1>
<p><code>base + write_register_base + write_register_byte * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.input" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.input" class="fnname">input</a>(&amp;mut self, register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.input" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#611-615" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Reads input to the contract call into the register. Input is expected to be in JSON-format.
If input is provided saves the bytes (potentially zero) of input into register. If input is
not provided writes 0 bytes into the register.</p>
<h1 id="cost-7" class="section-header"><a href="#cost-7">Cost</a></h1>
<p><code>base + write_register_base + write_register_byte * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.block_index" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.block_index" class="fnname">block_index</a>(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.block_index" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#623-626" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Returns the current block height.</p>
<h1 id="cost-8" class="section-header"><a href="#cost-8">Cost</a></h1>
<p><code>base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.block_timestamp" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.block_timestamp" class="fnname">block_timestamp</a>(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.block_timestamp" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#633-636" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Returns the current block timestamp (number of non-leap-nanoseconds since January 1, 1970 0:00:00 UTC).</p>
<h1 id="cost-9" class="section-header"><a href="#cost-9">Cost</a></h1>
<p><code>base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.epoch_height" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.epoch_height" class="fnname">epoch_height</a>(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="type" href="types/type.EpochHeight.html" title="type near_vm_logic::types::EpochHeight">EpochHeight</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.epoch_height" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#643-646" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Returns the current epoch height.</p>
<h1 id="cost-10" class="section-header"><a href="#cost-10">Cost</a></h1>
<p><code>base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.validator_stake" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.validator_stake" class="fnname">validator_stake</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;stake_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.validator_stake" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#654-665" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Get the stake of an account, if the account is currently a validator. Otherwise returns 0.
writes the value into the<code> u128</code> variable pointed by <code>stake_ptr</code>.</p>
<h1 id="cost-11" class="section-header"><a href="#cost-11">Cost</a></h1>
<p><code>base + memory_write_base + memory_write_size * 16 + utf8_decoding_base + utf8_decoding_byte * account_id_len + validator_stake_base</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.validator_total_stake" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.validator_total_stake" class="fnname">validator_total_stake</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;stake_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.validator_total_stake" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#674-679" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Get the total validator stake of the current epoch.
Write the u128 value into <code>stake_ptr</code>.
writes the value into the<code> u128</code> variable pointed by <code>stake_ptr</code>.</p>
<h1 id="cost-12" class="section-header"><a href="#cost-12">Cost</a></h1>
<p><code>base + memory_write_base + memory_write_size * 16 + validator_total_stake_base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.storage_usage" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.storage_usage" class="fnname">storage_usage</a>(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="type" href="types/type.StorageUsage.html" title="type near_vm_logic::types::StorageUsage">StorageUsage</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.storage_usage" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#691-694" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Returns the number of bytes used by the contract if it was saved to the trie as of the
invocation. This includes:</p>
<ul>
<li>The data written with storage_* functions during current and previous execution;</li>
<li>The bytes needed to store the access keys of the given account.</li>
<li>The contract code size</li>
<li>A small fixed overhead for account metadata.</li>
</ul>
<h1 id="cost-13" class="section-header"><a href="#cost-13">Cost</a></h1>
<p><code>base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.account_balance" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.account_balance" class="fnname">account_balance</a>(&amp;mut self, balance_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.account_balance" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#706-709" title="goto source code">[src]</a></div></summary><div class="docblock"><p>The current balance of the given account. This includes the attached_deposit that was
attached to the transaction.</p>
<h1 id="cost-14" class="section-header"><a href="#cost-14">Cost</a></h1>
<p><code>base + memory_write_base + memory_write_size * 16</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.account_locked_balance" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.account_locked_balance" class="fnname">account_locked_balance</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;balance_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.account_locked_balance" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#716-719" title="goto source code">[src]</a></div></summary><div class="docblock"><p>The current amount of tokens locked due to staking.</p>
<h1 id="cost-15" class="section-header"><a href="#cost-15">Cost</a></h1>
<p><code>base + memory_write_base + memory_write_size * 16</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.attached_deposit" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.attached_deposit" class="fnname">attached_deposit</a>(&amp;mut self, balance_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.attached_deposit" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#731-741" title="goto source code">[src]</a></div></summary><div class="docblock"><p>The balance that was attached to the call that will be immediately deposited before the
contract execution starts.</p>
<h1 id="errors-5" class="section-header"><a href="#errors-5">Errors</a></h1>
<p>If called as view function returns `ProhibitedInView``.</p>
<h1 id="cost-16" class="section-header"><a href="#cost-16">Cost</a></h1>
<p><code>base + memory_write_base + memory_write_size * 16</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.prepaid_gas" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.prepaid_gas" class="fnname">prepaid_gas</a>(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="type" href="types/type.Gas.html" title="type near_vm_logic::types::Gas">Gas</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.prepaid_gas" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#752-760" title="goto source code">[src]</a></div></summary><div class="docblock"><p>The amount of gas attached to the call that can be used to pay for the gas fees.</p>
<h1 id="errors-6" class="section-header"><a href="#errors-6">Errors</a></h1>
<p>If called as view function returns <code>ProhibitedInView</code>.</p>
<h1 id="cost-17" class="section-header"><a href="#cost-17">Cost</a></h1>
<p><code>base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.used_gas" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.used_gas" class="fnname">used_gas</a>(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="type" href="types/type.Gas.html" title="type near_vm_logic::types::Gas">Gas</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.used_gas" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#771-777" title="goto source code">[src]</a></div></summary><div class="docblock"><p>The gas that was already burnt during the contract execution (cannot exceed <code>prepaid_gas</code>)</p>
<h1 id="errors-7" class="section-header"><a href="#errors-7">Errors</a></h1>
<p>If called as view function returns <code>ProhibitedInView</code>.</p>
<h1 id="cost-18" class="section-header"><a href="#cost-18">Cost</a></h1>
<p><code>base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.random_seed" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.random_seed" class="fnname">random_seed</a>(&amp;mut self, register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.random_seed" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#883-886" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Writes random seed into the register.</p>
<h1 id="errors-8" class="section-header"><a href="#errors-8">Errors</a></h1>
<p>If the size of the registers exceed the set limit <code>MemoryAccessViolation</code>.</p>
<h1 id="cost-19" class="section-header"><a href="#cost-19">Cost</a></h1>
<p><code>base + write_register_base + write_register_byte * num_bytes</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.sha256" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.sha256" class="fnname">sha256</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.sha256" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#898-907" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Hashes the given value using sha256 and returns it into <code>register_id</code>.</p>
<h1 id="errors-9" class="section-header"><a href="#errors-9">Errors</a></h1>
<p>If <code>value_len + value_ptr</code> points outside the memory or the registers use more memory than
the limit with <code>MemoryAccessViolation</code>.</p>
<h1 id="cost-20" class="section-header"><a href="#cost-20">Cost</a></h1>
<p><code>base + write_register_base + write_register_byte * num_bytes + sha256_base + sha256_byte * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.keccak256" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.keccak256" class="fnname">keccak256</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.keccak256" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#919-928" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Hashes the given value using keccak256 and returns it into <code>register_id</code>.</p>
<h1 id="errors-10" class="section-header"><a href="#errors-10">Errors</a></h1>
<p>If <code>value_len + value_ptr</code> points outside the memory or the registers use more memory than
the limit with <code>MemoryAccessViolation</code>.</p>
<h1 id="cost-21" class="section-header"><a href="#cost-21">Cost</a></h1>
<p><code>base + write_register_base + write_register_byte * num_bytes + keccak256_base + keccak256_byte * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.keccak512" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.keccak512" class="fnname">keccak512</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.keccak512" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#940-949" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Hashes the given value using keccak512 and returns it into <code>register_id</code>.</p>
<h1 id="errors-11" class="section-header"><a href="#errors-11">Errors</a></h1>
<p>If <code>value_len + value_ptr</code> points outside the memory or the registers use more memory than
the limit with <code>MemoryAccessViolation</code>.</p>
<h1 id="cost-22" class="section-header"><a href="#cost-22">Cost</a></h1>
<p><code>base + write_register_base + write_register_byte * num_bytes + keccak512_base + keccak512_byte * num_bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.gas" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.gas" class="fnname">gas</a>(&amp;mut self, gas_amount: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u32.html">u32</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.gas" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#958-961" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Called by gas metering injected into Wasm. Counts both towards <code>burnt_gas</code> and <code>used_gas</code>.</p>
<h1 id="errors-12" class="section-header"><a href="#errors-12">Errors</a></h1>
<ul>
<li>If passed gas amount somehow overflows internal gas counters returns <code>IntegerOverflow</code>;</li>
<li>If we exceed usage limit imposed on burnt gas returns <code>GasLimitExceeded</code>;</li>
<li>If we exceed the <code>prepaid_gas</code> then returns <code>GasExceeded</code>.</li>
</ul>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_create" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_create" class="fnname">promise_create</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;method_name_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;method_name_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;arguments_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;arguments_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;amount_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;gas: <a class="type" href="types/type.Gas.html" title="type near_vm_logic::types::Gas">Gas</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_create" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1025-1047" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Creates a promise that will execute a method on account with given arguments and attaches
the given amount and gas. <code>amount_ptr</code> point to slices of bytes representing <code>u128</code>.</p>
<h1 id="errors-13" class="section-header"><a href="#errors-13">Errors</a></h1>
<ul>
<li>If <code>account_id_len + account_id_ptr</code> or <code>method_name_len + method_name_ptr</code> or
<code>arguments_len + arguments_ptr</code> or <code>amount_ptr + 16</code> points outside the memory of the guest
or host returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="returns" class="section-header"><a href="#returns">Returns</a></h1>
<p>Index of the new promise that uniquely identifies it within the current execution of the
method.</p>
<h1 id="cost-23" class="section-header"><a href="#cost-23">Cost</a></h1>
<p>Since <code>promise_create</code> is a convenience wrapper around <code>promise_batch_create</code> and
<code>promise_batch_action_function_call</code>. This also means it charges <code>base</code> cost twice.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_then" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_then" class="fnname">promise_then</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;method_name_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;method_name_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;arguments_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;arguments_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;amount_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;gas: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_then" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1068-1092" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Attaches the callback that is executed after promise pointed by <code>promise_idx</code> is complete.</p>
<h1 id="errors-14" class="section-header"><a href="#errors-14">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>;</li>
<li>If <code>account_id_len + account_id_ptr</code> or <code>method_name_len + method_name_ptr</code> or
<code>arguments_len + arguments_ptr</code> or <code>amount_ptr + 16</code> points outside the memory of the
guest or host returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="returns-1" class="section-header"><a href="#returns-1">Returns</a></h1>
<p>Index of the new promise that uniquely identifies it within the current execution of the
method.</p>
<h1 id="cost-24" class="section-header"><a href="#cost-24">Cost</a></h1>
<p>Since <code>promise_create</code> is a convenience wrapper around <code>promise_batch_then</code> and
<code>promise_batch_action_function_call</code>. This also means it charges <code>base</code> cost twice.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_and" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_and" class="fnname">promise_and</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx_count: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="type" href="types/type.PromiseIndex.html" title="type near_vm_logic::types::PromiseIndex">PromiseIndex</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_and" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1119-1166" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Creates a new promise which completes when time all promises passed as arguments complete.
Cannot be used with registers. <code>promise_idx_ptr</code> points to an array of <code>u64</code> elements, with
<code>promise_idx_count</code> denoting the number of elements. The array contains indices of promises
that need to be waited on jointly.</p>
<h1 id="errors-15" class="section-header"><a href="#errors-15">Errors</a></h1>
<ul>
<li>If <code>promise_ids_ptr + 8 * promise_idx_count</code> extend outside the guest memory returns
<code>MemoryAccessViolation</code>;</li>
<li>If any of the promises in the array do not correspond to existing promises returns
<code>InvalidPromiseIndex</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
<li>If the total number of receipt dependencies exceeds <code>max_number_input_data_dependencies</code>
limit returns <code>NumInputDataDependenciesExceeded</code>.</li>
<li>If the total number of promises exceeds <code>max_promises_per_function_call_action</code> limit
returns <code>NumPromisesExceeded</code>.</li>
</ul>
<h1 id="returns-2" class="section-header"><a href="#returns-2">Returns</a></h1>
<p>Index of the new promise that uniquely identifies it within the current execution of the
method.</p>
<h1 id="cost-25" class="section-header"><a href="#cost-25">Cost</a></h1>
<p><code>base + promise_and_base + promise_and_per_promise * num_promises + cost of reading promise ids from memory</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_create" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_create" class="fnname">promise_batch_create</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_create" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1187-1206" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Creates a new promise towards given <code>account_id</code> without any actions attached to it.</p>
<h1 id="errors-16" class="section-header"><a href="#errors-16">Errors</a></h1>
<ul>
<li>If <code>account_id_len + account_id_ptr</code> points outside the memory of the guest or host
returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
<li>If the total number of promises exceeds <code>max_promises_per_function_call_action</code> limit
returns <code>NumPromisesExceeded</code>.</li>
</ul>
<h1 id="returns-3" class="section-header"><a href="#returns-3">Returns</a></h1>
<p>Index of the new promise that uniquely identifies it within the current execution of the
method.</p>
<h1 id="cost-26" class="section-header"><a href="#cost-26">Cost</a></h1>
<p><code>burnt_gas := base + cost of reading and decoding the account id + dispatch cost of the receipt</code>.
<code>used_gas := burnt_gas + exec cost of the receipt</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_then" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_then" class="fnname">promise_batch_then</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;account_id_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_then" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1229-1269" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Creates a new promise towards given <code>account_id</code> without any actions attached, that is
executed after promise pointed by <code>promise_idx</code> is complete.</p>
<h1 id="errors-17" class="section-header"><a href="#errors-17">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>;</li>
<li>If <code>account_id_len + account_id_ptr</code> points outside the memory of the guest or host
returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
<li>If the total number of promises exceeds <code>max_promises_per_function_call_action</code> limit
returns <code>NumPromisesExceeded</code>.</li>
</ul>
<h1 id="returns-4" class="section-header"><a href="#returns-4">Returns</a></h1>
<p>Index of the new promise that uniquely identifies it within the current execution of the
method.</p>
<h1 id="cost-27" class="section-header"><a href="#cost-27">Cost</a></h1>
<p><code>base + cost of reading and decoding the account id + dispatch&amp;execution cost of the receipt + dispatch&amp;execution base cost for each data dependency</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_action_create_account" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_action_create_account" class="fnname">promise_batch_action_create_account</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_action_create_account" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1309-1327" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Appends <code>CreateAccount</code> action to the batch of actions for the given promise pointed by
<code>promise_idx</code>.</p>
<h1 id="errors-18" class="section-header"><a href="#errors-18">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If the promise pointed by the <code>promise_idx</code> is an ephemeral promise created by
<code>promise_and</code> returns <code>CannotAppendActionToJointPromise</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-28" class="section-header"><a href="#cost-28">Cost</a></h1>
<p><code>burnt_gas := base + dispatch action fee</code>
<code>used_gas := burnt_gas + exec action fee</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_action_deploy_contract" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_action_deploy_contract" class="fnname">promise_batch_action_deploy_contract</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;code_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;code_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_action_deploy_contract" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1346-1385" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Appends <code>DeployContract</code> action to the batch of actions for the given promise pointed by
<code>promise_idx</code>.</p>
<h1 id="errors-19" class="section-header"><a href="#errors-19">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If the promise pointed by the <code>promise_idx</code> is an ephemeral promise created by
<code>promise_and</code> returns <code>CannotAppendActionToJointPromise</code>.</li>
<li>If <code>code_len + code_ptr</code> points outside the memory of the guest or host returns
<code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
<li>If the contract code length exceeds <code>max_contract_size</code> returns <code>ContractSizeExceeded</code>.</li>
</ul>
<h1 id="cost-29" class="section-header"><a href="#cost-29">Cost</a></h1>
<p><code>burnt_gas := base + dispatch action base fee + dispatch action per byte fee * num bytes + cost of reading vector from memory </code>
<code>used_gas := burnt_gas + exec action base fee + exec action per byte fee * num bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_action_function_call" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_action_function_call" class="fnname">promise_batch_action_function_call</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;method_name_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;method_name_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;arguments_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;arguments_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;amount_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;gas: <a class="type" href="types/type.Gas.html" title="type near_vm_logic::types::Gas">Gas</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_action_function_call" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1405-1451" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Appends <code>FunctionCall</code> action to the batch of actions for the given promise pointed by
<code>promise_idx</code>.</p>
<h1 id="errors-20" class="section-header"><a href="#errors-20">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If the promise pointed by the <code>promise_idx</code> is an ephemeral promise created by
<code>promise_and</code> returns <code>CannotAppendActionToJointPromise</code>.</li>
<li>If <code>method_name_len + method_name_ptr</code> or <code>arguments_len + arguments_ptr</code> or
<code>amount_ptr + 16</code> points outside the memory of the guest or host returns
<code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-30" class="section-header"><a href="#cost-30">Cost</a></h1>
<p><code>burnt_gas := base + dispatch action base fee + dispatch action per byte fee * num bytes + cost of reading vector from memory + cost of reading u128, method_name and arguments from the memory</code>
<code>used_gas := burnt_gas + exec action base fee + exec action per byte fee * num bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_action_transfer" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_action_transfer" class="fnname">promise_batch_action_transfer</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;amount_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_action_transfer" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1469-1514" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Appends <code>Transfer</code> action to the batch of actions for the given promise pointed by
<code>promise_idx</code>.</p>
<h1 id="errors-21" class="section-header"><a href="#errors-21">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If the promise pointed by the <code>promise_idx</code> is an ephemeral promise created by
<code>promise_and</code> returns <code>CannotAppendActionToJointPromise</code>.</li>
<li>If <code>amount_ptr + 16</code> points outside the memory of the guest or host returns
<code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-31" class="section-header"><a href="#cost-31">Cost</a></h1>
<p><code>burnt_gas := base + dispatch action base fee + dispatch action per byte fee * num bytes + cost of reading u128 from memory </code>
<code>used_gas := burnt_gas + exec action base fee + exec action per byte fee * num bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_action_stake" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_action_stake" class="fnname">promise_batch_action_stake</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;amount_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;public_key_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;public_key_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_action_stake" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1533-1560" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Appends <code>Stake</code> action to the batch of actions for the given promise pointed by
<code>promise_idx</code>.</p>
<h1 id="errors-22" class="section-header"><a href="#errors-22">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If the promise pointed by the <code>promise_idx</code> is an ephemeral promise created by
<code>promise_and</code> returns <code>CannotAppendActionToJointPromise</code>.</li>
<li>If the given public key is not a valid (e.g. wrong length) returns <code>InvalidPublicKey</code>.</li>
<li>If <code>amount_ptr + 16</code> or <code>public_key_len + public_key_ptr</code> points outside the memory of the
guest or host returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-32" class="section-header"><a href="#cost-32">Cost</a></h1>
<p><code>burnt_gas := base + dispatch action base fee + dispatch action per byte fee * num bytes + cost of reading public key from memory </code>
<code>used_gas := burnt_gas + exec action base fee + exec action per byte fee * num bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_action_add_key_with_full_access" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_action_add_key_with_full_access" class="fnname">promise_batch_action_add_key_with_full_access</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;public_key_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;public_key_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;nonce: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_action_add_key_with_full_access" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1579-1605" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Appends <code>AddKey</code> action to the batch of actions for the given promise pointed by
<code>promise_idx</code>. The access key will have <code>FullAccess</code> permission.</p>
<h1 id="errors-23" class="section-header"><a href="#errors-23">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If the promise pointed by the <code>promise_idx</code> is an ephemeral promise created by
<code>promise_and</code> returns <code>CannotAppendActionToJointPromise</code>.</li>
<li>If the given public key is not a valid (e.g. wrong length) returns <code>InvalidPublicKey</code>.</li>
<li>If <code>public_key_len + public_key_ptr</code> points outside the memory of the guest or host
returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-33" class="section-header"><a href="#cost-33">Cost</a></h1>
<p><code>burnt_gas := base + dispatch action base fee + dispatch action per byte fee * num bytes + cost of reading public key from memory </code>
<code>used_gas := burnt_gas + exec action base fee + exec action per byte fee * num bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_action_add_key_with_function_call" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_action_add_key_with_function_call" class="fnname">promise_batch_action_add_key_with_function_call</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;public_key_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;public_key_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;nonce: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;allowance_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;receiver_id_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;receiver_id_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;method_names_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;method_names_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_action_add_key_with_function_call" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1626-1678" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Appends <code>AddKey</code> action to the batch of actions for the given promise pointed by
<code>promise_idx</code>. The access key will have <code>FunctionCall</code> permission.</p>
<h1 id="errors-24" class="section-header"><a href="#errors-24">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If the promise pointed by the <code>promise_idx</code> is an ephemeral promise created by
<code>promise_and</code> returns <code>CannotAppendActionToJointPromise</code>.</li>
<li>If the given public key is not a valid (e.g. wrong length) returns <code>InvalidPublicKey</code>.</li>
<li>If <code>public_key_len + public_key_ptr</code>, <code>allowance_ptr + 16</code>,
<code>receiver_id_len + receiver_id_ptr</code> or <code>method_names_len + method_names_ptr</code> points outside
the memory of the guest or host returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-34" class="section-header"><a href="#cost-34">Cost</a></h1>
<p><code>burnt_gas := base + dispatch action base fee + dispatch action per byte fee * num bytes + cost of reading vector from memory + cost of reading u128, method_names and public key from the memory + cost of reading and parsing account name</code>
<code>used_gas := burnt_gas + exec action base fee + exec action per byte fee * num bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_action_delete_key" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_action_delete_key" class="fnname">promise_batch_action_delete_key</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;public_key_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;public_key_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_action_delete_key" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1697-1722" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Appends <code>DeleteKey</code> action to the batch of actions for the given promise pointed by
<code>promise_idx</code>.</p>
<h1 id="errors-25" class="section-header"><a href="#errors-25">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If the promise pointed by the <code>promise_idx</code> is an ephemeral promise created by
<code>promise_and</code> returns <code>CannotAppendActionToJointPromise</code>.</li>
<li>If the given public key is not a valid (e.g. wrong length) returns <code>InvalidPublicKey</code>.</li>
<li>If <code>public_key_len + public_key_ptr</code> points outside the memory of the guest or host
returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-35" class="section-header"><a href="#cost-35">Cost</a></h1>
<p><code>burnt_gas := base + dispatch action base fee + dispatch action per byte fee * num bytes + cost of reading public key from memory </code>
<code>used_gas := burnt_gas + exec action base fee + exec action per byte fee * num bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_batch_action_delete_account" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_batch_action_delete_account" class="fnname">promise_batch_action_delete_account</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;beneficiary_id_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;beneficiary_id_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_batch_action_delete_account" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1740-1766" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Appends <code>DeleteAccount</code> action to the batch of actions for the given promise pointed by
<code>promise_idx</code>.</p>
<h1 id="errors-26" class="section-header"><a href="#errors-26">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If the promise pointed by the <code>promise_idx</code> is an ephemeral promise created by
<code>promise_and</code> returns <code>CannotAppendActionToJointPromise</code>.</li>
<li>If <code>beneficiary_id_len + beneficiary_id_ptr</code> points outside the memory of the guest or
host returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-36" class="section-header"><a href="#cost-36">Cost</a></h1>
<p><code>burnt_gas := base + dispatch action base fee + dispatch action per byte fee * num bytes + cost of reading and parsing account id from memory </code>
<code>used_gas := burnt_gas + exec action base fee + exec action per byte fee * num bytes</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_results_count" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_results_count" class="fnname">promise_results_count</a>(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_results_count" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1782-1791" title="goto source code">[src]</a></div></summary><div class="docblock"><p>If the current function is invoked by a callback we can access the execution results of the
promises that caused the callback. This function returns the number of complete and
incomplete callbacks.</p>
<p>Note, we are only going to have incomplete callbacks once we have promise_or combinator.</p>
<ul>
<li>If there is only one callback returns <code>1</code>;</li>
<li>If there are multiple callbacks (e.g. created through <code>promise_and</code>) returns their number;</li>
<li>If the function was called not through the callback returns <code>0</code>.</li>
</ul>
<h1 id="cost-37" class="section-header"><a href="#cost-37">Cost</a></h1>
<p><code>base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_result" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_result" class="fnname">promise_result</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;result_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_result" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1815-1834" title="goto source code">[src]</a></div></summary><div class="docblock"><p>If the current function is invoked by a callback we can access the execution results of the
promises that caused the callback. This function returns the result in blob format and
places it into the register.</p>
<ul>
<li>If promise result is complete and successful copies its blob into the register;</li>
<li>If promise result is complete and failed or incomplete keeps register unused;</li>
</ul>
<h1 id="returns-5" class="section-header"><a href="#returns-5">Returns</a></h1>
<ul>
<li>If promise result is not complete returns <code>0</code>;</li>
<li>If promise result is complete and successful returns <code>1</code>;</li>
<li>If promise result is complete and failed returns <code>2</code>.</li>
</ul>
<h1 id="errors-27" class="section-header"><a href="#errors-27">Errors</a></h1>
<ul>
<li>If <code>result_id</code> does not correspond to an existing result returns <code>InvalidPromiseResultIndex</code>;</li>
<li>If copying the blob exhausts the memory limit it returns <code>MemoryAccessViolation</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-38" class="section-header"><a href="#cost-38">Cost</a></h1>
<p><code>base + cost of writing data into a register</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.promise_return" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.promise_return" class="fnname">promise_return</a>(&amp;mut self, promise_idx: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.promise_return" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1847-1866" title="goto source code">[src]</a></div></summary><div class="docblock"><p>When promise <code>promise_idx</code> finishes executing its result is considered to be the result of
the current function.</p>
<h1 id="errors-28" class="section-header"><a href="#errors-28">Errors</a></h1>
<ul>
<li>If <code>promise_idx</code> does not correspond to an existing promise returns <code>InvalidPromiseIndex</code>.</li>
<li>If called as view function returns <code>ProhibitedInView</code>.</li>
</ul>
<h1 id="cost-39" class="section-header"><a href="#cost-39">Cost</a></h1>
<p><code>base + promise_return</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.value_return" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.value_return" class="fnname">value_return</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.value_return" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1883-1920" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Sets the blob of data as the return value of the contract.</p>
<h1 id="errors-29" class="section-header"><a href="#errors-29">Errors</a></h1>
<ul>
<li>If <code>value_len + value_ptr</code> exceeds the memory container or points to an unused register it
returns <code>MemoryAccessViolation</code>.</li>
<li>if the length of the returned data exceeds <code>max_length_returned_data</code> returns
<code>ReturnedValueLengthExceeded</code>.</li>
</ul>
<h1 id="cost-40" class="section-header"><a href="#cost-40">Cost</a></h1>
<p><code>base + cost of reading return value from memory or register + dispatch&amp;exec cost per byte of the data sent * num data receivers</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.panic" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.panic" class="fnname">panic</a>(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.panic" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1927-1930" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Terminates the execution of the program with panic <code>GuestPanic</code>.</p>
<h1 id="cost-41" class="section-header"><a href="#cost-41">Cost</a></h1>
<p><code>base</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.panic_utf8" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.panic_utf8" class="fnname">panic_utf8</a>(&amp;mut self, len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.panic_utf8" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1943-1946" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Guest panics with the UTF-8 encoded string.
If <code>len == u64::MAX</code> then treats the string as null-terminated with character <code>'\0'</code>.</p>
<h1 id="errors-30" class="section-header"><a href="#errors-30">Errors</a></h1>
<ul>
<li>If string extends outside the memory of the guest with <code>MemoryAccessViolation</code>;</li>
<li>If string is not UTF-8 returns <code>BadUtf8</code>.</li>
<li>If string is longer than <code>max_log_len</code> returns <code>TotalLogLengthExceeded</code>.</li>
</ul>
<h1 id="cost-42" class="section-header"><a href="#cost-42">Cost</a></h1>
<p><code>base + cost of reading and decoding a utf8 string</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.log_utf8" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.log_utf8" class="fnname">log_utf8</a>(&amp;mut self, len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.log_utf8" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1963-1970" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Logs the UTF-8 encoded string.
If <code>len == u64::MAX</code> then treats the string as null-terminated with character <code>'\0'</code>.</p>
<h1 id="errors-31" class="section-header"><a href="#errors-31">Errors</a></h1>
<ul>
<li>If string extends outside the memory of the guest with <code>MemoryAccessViolation</code>;</li>
<li>If string is not UTF-8 returns <code>BadUtf8</code>.</li>
<li>If number of bytes read + <code>total_log_length</code> exceeds the <code>max_total_log_length</code> returns
<code>TotalLogLengthExceeded</code>.</li>
<li>If the total number of logs will exceed the <code>max_number_logs</code> returns
<code>NumberOfLogsExceeded</code>.</li>
</ul>
<h1 id="cost-43" class="section-header"><a href="#cost-43">Cost</a></h1>
<p><code>base + log_base + log_byte + num_bytes + utf8 decoding cost</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.log_utf16" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.log_utf16" class="fnname">log_utf16</a>(&amp;mut self, len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.log_utf16" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#1987-1995" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Logs the UTF-16 encoded string. If <code>len == u64::MAX</code> then treats the string as
null-terminated with two-byte sequence of <code>0x00 0x00</code>.</p>
<h1 id="errors-32" class="section-header"><a href="#errors-32">Errors</a></h1>
<ul>
<li>If string extends outside the memory of the guest with <code>MemoryAccessViolation</code>;</li>
<li>If string is not UTF-16 returns <code>BadUtf16</code>.</li>
<li>If number of bytes read + <code>total_log_length</code> exceeds the <code>max_total_log_length</code> returns
<code>TotalLogLengthExceeded</code>.</li>
<li>If the total number of logs will exceed the <code>max_number_logs</code> returns
<code>NumberOfLogsExceeded</code>.</li>
</ul>
<h1 id="cost-44" class="section-header"><a href="#cost-44">Cost</a></h1>
<p><code>base + log_base + log_byte * num_bytes + utf16 decoding cost</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.abort" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.abort" class="fnname">abort</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;msg_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u32.html">u32</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;filename_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u32.html">u32</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;line: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u32.html">u32</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;col: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u32.html">u32</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.abort" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2012-2032" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Special import kept for compatibility with AssemblyScript contracts. Not called by smart
contracts directly, but instead called by the code generated by AssemblyScript.</p>
<h1 id="errors-33" class="section-header"><a href="#errors-33">Errors</a></h1>
<ul>
<li>If string extends outside the memory of the guest with <code>MemoryAccessViolation</code>;</li>
<li>If string is not UTF-8 returns <code>BadUtf8</code>.</li>
<li>If number of bytes read + <code>total_log_length</code> exceeds the <code>max_total_log_length</code> returns
<code>TotalLogLengthExceeded</code>.</li>
<li>If the total number of logs will exceed the <code>max_number_logs</code> returns
<code>NumberOfLogsExceeded</code>.</li>
</ul>
<h1 id="cost-45" class="section-header"><a href="#cost-45">Cost</a></h1>
<p><code>base +  log_base + log_byte * num_bytes + utf16 decoding cost</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.storage_write" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.storage_write" class="fnname">storage_write</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;value_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.storage_write" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2078-2147" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Writes key-value into storage.</p>
<ul>
<li>If key is not in use it inserts the key-value pair and does not modify the register. Returns <code>0</code>;</li>
<li>If key is in use it inserts the key-value and copies the old value into the <code>register_id</code>. Returns <code>1</code>.</li>
</ul>
<h1 id="errors-34" class="section-header"><a href="#errors-34">Errors</a></h1>
<ul>
<li>If <code>key_len + key_ptr</code> or <code>value_len + value_ptr</code> exceeds the memory container or points
to an unused register it returns <code>MemoryAccessViolation</code>;</li>
<li>If returning the preempted value into the registers exceed the memory container it returns
<code>MemoryAccessViolation</code>.</li>
<li>If the length of the key exceeds <code>max_length_storage_key</code> returns <code>KeyLengthExceeded</code>.</li>
<li>If the length of the value exceeds <code>max_length_storage_value</code> returns
<code>ValueLengthExceeded</code>.</li>
<li>If called as view function returns `ProhibitedInView``.</li>
</ul>
<h1 id="cost-46" class="section-header"><a href="#cost-46">Cost</a></h1>
<p><code>base + storage_write_base + storage_write_key_byte * num_key_bytes + storage_write_value_byte * num_value_bytes + get_vec_from_memory_or_register_cost x 2</code>.</p>
<p>If a value was evicted it costs additional <code>storage_write_value_evicted_byte * num_evicted_bytes + internal_write_register_cost</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.storage_read" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.storage_read" class="fnname">storage_read</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.storage_read" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2180-2204" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Reads the value stored under the given key.</p>
<ul>
<li>If key is used copies the content of the value into the <code>register_id</code>, even if the content
is zero bytes. Returns <code>1</code>;</li>
<li>If key is not present then does not modify the register. Returns <code>0</code>;</li>
</ul>
<h1 id="errors-35" class="section-header"><a href="#errors-35">Errors</a></h1>
<ul>
<li>If <code>key_len + key_ptr</code> exceeds the memory container or points to an unused register it
returns <code>MemoryAccessViolation</code>;</li>
<li>If returning the preempted value into the registers exceed the memory container it returns
<code>MemoryAccessViolation</code>.</li>
<li>If the length of the key exceeds <code>max_length_storage_key</code> returns <code>KeyLengthExceeded</code>.</li>
</ul>
<h1 id="cost-47" class="section-header"><a href="#cost-47">Cost</a></h1>
<p><code>base + storage_read_base + storage_read_key_byte * num_key_bytes + storage_read_value_byte + num_value_bytes cost to read key from register + cost to write value into register</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.storage_remove" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.storage_remove" class="fnname">storage_remove</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.storage_remove" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2225-2267" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Removes the value stored under the given key.</p>
<ul>
<li>If key is used, removes the key-value from the trie and copies the content of the value
into the <code>register_id</code>, even if the content is zero bytes. Returns <code>1</code>;</li>
<li>If key is not present then does not modify the register. Returns <code>0</code>.</li>
</ul>
<h1 id="errors-36" class="section-header"><a href="#errors-36">Errors</a></h1>
<ul>
<li>If <code>key_len + key_ptr</code> exceeds the memory container or points to an unused register it
returns <code>MemoryAccessViolation</code>;</li>
<li>If the registers exceed the memory limit returns <code>MemoryAccessViolation</code>;</li>
<li>If returning the preempted value into the registers exceed the memory container it returns
<code>MemoryAccessViolation</code>.</li>
<li>If the length of the key exceeds <code>max_length_storage_key</code> returns <code>KeyLengthExceeded</code>.</li>
<li>If called as view function returns `ProhibitedInView``.</li>
</ul>
<h1 id="cost-48" class="section-header"><a href="#cost-48">Cost</a></h1>
<p><code>base + storage_remove_base + storage_remove_key_byte * num_key_bytes + storage_remove_ret_value_byte * num_value_bytes + cost to read the key + cost to write the value</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.storage_has_key" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.storage_has_key" class="fnname">storage_has_key</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.storage_has_key" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2281-2298" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Checks if there is a key-value pair.</p>
<ul>
<li>If key is used returns <code>1</code>, even if the value is zero bytes;</li>
<li>Otherwise returns <code>0</code>.</li>
</ul>
<h1 id="errors-37" class="section-header"><a href="#errors-37">Errors</a></h1>
<ul>
<li>If <code>key_len + key_ptr</code> exceeds the memory container it returns <code>MemoryAccessViolation</code>.</li>
<li>If the length of the key exceeds <code>max_length_storage_key</code> returns <code>KeyLengthExceeded</code>.</li>
</ul>
<h1 id="cost-49" class="section-header"><a href="#cost-49">Cost</a></h1>
<p><code>base + storage_has_key_base + storage_has_key_byte * num_bytes + cost of reading key</code></p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.storage_iter_prefix" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.storage_iter_prefix" class="fnname">storage_iter_prefix</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;_prefix_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;_prefix_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.storage_iter_prefix" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2317-2321" title="goto source code">[src]</a></div></summary><div class="docblock"><p>DEPRECATED
Creates an iterator object inside the host. Returns the identifier that uniquely
differentiates the given iterator from other iterators that can be simultaneously created.</p>
<ul>
<li>It iterates over the keys that have the provided prefix. The order of iteration is defined
by the lexicographic order of the bytes in the keys;</li>
<li>If there are no keys, it creates an empty iterator, see below on empty iterators.</li>
</ul>
<h1 id="errors-38" class="section-header"><a href="#errors-38">Errors</a></h1>
<ul>
<li>If <code>prefix_len + prefix_ptr</code> exceeds the memory container it returns
<code>MemoryAccessViolation</code>.</li>
<li>If the length of the prefix exceeds <code>max_length_storage_key</code> returns <code>KeyLengthExceeded</code>.</li>
</ul>
<h1 id="cost-50" class="section-header"><a href="#cost-50">Cost</a></h1>
<p><code>base + storage_iter_create_prefix_base + storage_iter_create_key_byte * num_prefix_bytes cost of reading the prefix</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.storage_iter_range" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.storage_iter_range" class="fnname">storage_iter_range</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;_start_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;_start_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;_end_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;_end_ptr: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.storage_iter_range" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2340-2350" title="goto source code">[src]</a></div></summary><div class="docblock"><p>DEPRECATED
Iterates over all key-values such that keys are between <code>start</code> and <code>end</code>, where <code>start</code> is
inclusive and <code>end</code> is exclusive. Unless lexicographically <code>start &lt; end</code>, it creates an
empty iterator. Note, this definition allows for <code>start</code> or <code>end</code> keys to not actually exist
on the given trie.</p>
<h1 id="errors-39" class="section-header"><a href="#errors-39">Errors</a></h1>
<ul>
<li>If <code>start_len + start_ptr</code> or <code>end_len + end_ptr</code> exceeds the memory container or points to
an unused register it returns <code>MemoryAccessViolation</code>.</li>
<li>If the length of the <code>start</code> exceeds <code>max_length_storage_key</code> returns <code>KeyLengthExceeded</code>.</li>
<li>If the length of the <code>end</code> exceeds <code>max_length_storage_key</code> returns <code>KeyLengthExceeded</code>.</li>
</ul>
<h1 id="cost-51" class="section-header"><a href="#cost-51">Cost</a></h1>
<p><code>base + storage_iter_create_range_base + storage_iter_create_from_byte * num_from_bytes + storage_iter_create_to_byte * num_to_bytes + reading from prefix + reading to prefix</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.storage_iter_next" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.storage_iter_next" class="fnname">storage_iter_next</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;_iterator_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;_key_register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;_value_register_id: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.storage_iter_next" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2380-2389" title="goto source code">[src]</a></div></summary><div class="docblock"><p>DEPRECATED
Advances iterator and saves the next key and value in the register.</p>
<ul>
<li>If iterator is not empty (after calling next it points to a key-value), copies the key
into <code>key_register_id</code> and value into <code>value_register_id</code> and returns <code>1</code>;</li>
<li>If iterator is empty returns <code>0</code>;
This allows us to iterate over the keys that have zero bytes stored in values.</li>
</ul>
<h1 id="errors-40" class="section-header"><a href="#errors-40">Errors</a></h1>
<ul>
<li>If <code>key_register_id == value_register_id</code> returns <code>MemoryAccessViolation</code>;</li>
<li>If the registers exceed the memory limit returns <code>MemoryAccessViolation</code>;</li>
<li>If <code>iterator_id</code> does not correspond to an existing iterator returns <code>InvalidIteratorId</code>;</li>
<li>If between the creation of the iterator and calling <code>storage_iter_next</code> the range over
which it iterates was modified returns <code>IteratorWasInvalidated</code>. Specifically, if
<code>storage_write</code> or <code>storage_remove</code> was invoked on the key key such that:
<ul>
<li>in case of <code>storage_iter_prefix</code>. <code>key</code> has the given prefix and:
<ul>
<li>Iterator was not called next yet.</li>
<li><code>next</code> was already called on the iterator and it is currently pointing at the <code>key</code>
<code>curr</code> such that <code>curr &lt;= key</code>.</li>
</ul>
</li>
<li>in case of <code>storage_iter_range</code>. <code>start&lt;=key&lt;end</code> and:
<ul>
<li>Iterator was not called <code>next</code> yet.</li>
<li><code>next</code> was already called on the iterator and it is currently pointing at the key
<code>curr</code> such that <code>curr&lt;=key&lt;end</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="cost-52" class="section-header"><a href="#cost-52">Cost</a></h1>
<p>`base + storage_iter_next_base + storage_iter_next_key_byte * num_key_bytes + storage_iter_next_value_byte * num_value_bytes</p>
<ul>
<li>writing key to register + writing value to register`.</li>
</ul>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.outcome" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.outcome" class="fnname">outcome</a>(self) -&gt; <a class="struct" href="struct.VMOutcome.html" title="struct near_vm_logic::VMOutcome">VMOutcome</a></h4><a href="#method.outcome" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2392-2401" title="goto source code">[src]</a></div></summary><div class="docblock"><p>Computes the outcome of execution.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.clone_outcome" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.clone_outcome" class="fnname">clone_outcome</a>(&amp;self) -&gt; <a class="struct" href="struct.VMOutcome.html" title="struct near_vm_logic::VMOutcome">VMOutcome</a></h4><a href="#method.clone_outcome" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2404-2415" title="goto source code">[src]</a></div></summary><div class="docblock"><p>clones the outcome of execution.</p>
</div></details><div id="method.add_contract_compile_fee" class="method has-srclink"><h4 class="code-header">pub fn <a href="#method.add_contract_compile_fee" class="fnname">add_contract_compile_fee</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;code_len: <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.unit.html">()</a>, <a class="enum" href="enum.VMLogicError.html" title="enum near_vm_logic::VMLogicError">VMLogicError</a>&gt;</h4><a href="#method.add_contract_compile_fee" class="anchor"></a><a class="srclink" href="../src/near_vm_logic/logic.rs.html#2417-2420" title="goto source code">[src]</a></div></div></details><h2 id="synthetic-implementations" class="small-section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor"></a></h2><div id="synthetic-implementations-list"><div id="impl-RefUnwindSafe" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;'a&gt; !<a class="trait" href="https://doc.rust-lang.org/1.54.0/std/panic/trait.RefUnwindSafe.html" title="trait std::panic::RefUnwindSafe">RefUnwindSafe</a> for <a class="struct" href="struct.VMLogic.html" title="struct near_vm_logic::VMLogic">VMLogic</a>&lt;'a&gt;</h3><a href="#impl-RefUnwindSafe" class="anchor"></a></div><div id="impl-Send" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;'a&gt; !<a class="trait" href="https://doc.rust-lang.org/1.54.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> for <a class="struct" href="struct.VMLogic.html" title="struct near_vm_logic::VMLogic">VMLogic</a>&lt;'a&gt;</h3><a href="#impl-Send" class="anchor"></a></div><div id="impl-Sync" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;'a&gt; !<a class="trait" href="https://doc.rust-lang.org/1.54.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> for <a class="struct" href="struct.VMLogic.html" title="struct near_vm_logic::VMLogic">VMLogic</a>&lt;'a&gt;</h3><a href="#impl-Sync" class="anchor"></a></div><div id="impl-Unpin" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;'a&gt; <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> for <a class="struct" href="struct.VMLogic.html" title="struct near_vm_logic::VMLogic">VMLogic</a>&lt;'a&gt;</h3><a href="#impl-Unpin" class="anchor"></a></div><div id="impl-UnwindSafe" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;'a&gt; !<a class="trait" href="https://doc.rust-lang.org/1.54.0/std/panic/trait.UnwindSafe.html" title="trait std::panic::UnwindSafe">UnwindSafe</a> for <a class="struct" href="struct.VMLogic.html" title="struct near_vm_logic::VMLogic">VMLogic</a>&lt;'a&gt;</h3><a href="#impl-UnwindSafe" class="anchor"></a></div></div><h2 id="blanket-implementations" class="small-section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor"></a></h2><div id="blanket-implementations-list"><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Any" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/any/trait.Any.html" title="trait core::any::Any">Any</a> for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: 'static + ?<a class="trait" href="https://doc.rust-lang.org/1.54.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h3><a href="#impl-Any" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/any.rs.html#131-135" title="goto source code">[src]</a></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.type_id" class="method trait-impl has-srclink"><h4 class="code-header">pub fn <a href="https://doc.rust-lang.org/1.54.0/core/any/trait.Any.html#tymethod.type_id" class="fnname">type_id</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.54.0/core/any/struct.TypeId.html" title="struct core::any::TypeId">TypeId</a></h4><a href="#method.type_id" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/any.rs.html#132" title="goto source code">[src]</a></div></summary><div class='docblock'><p>Gets the <code>TypeId</code> of <code>self</code>. <a href="https://doc.rust-lang.org/1.54.0/core/any/trait.Any.html#tymethod.type_id">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Borrow%3CT%3E" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;T&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="https://doc.rust-lang.org/1.54.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h3><a href="#impl-Borrow%3CT%3E" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/borrow.rs.html#208-213" title="goto source code">[src]</a></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.borrow" class="method trait-impl has-srclink"><h4 class="code-header">pub fn <a href="https://doc.rust-lang.org/1.54.0/core/borrow/trait.Borrow.html#tymethod.borrow" class="fnname">borrow</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.reference.html">&amp;</a>T</h4><a href="#method.borrow" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/borrow.rs.html#210" title="goto source code">[src]</a></div></summary><div class='docblock'><p>Immutably borrows from an owned value. <a href="https://doc.rust-lang.org/1.54.0/core/borrow/trait.Borrow.html#tymethod.borrow">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-BorrowMut%3CT%3E" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/borrow/trait.BorrowMut.html" title="trait core::borrow::BorrowMut">BorrowMut</a>&lt;T&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="https://doc.rust-lang.org/1.54.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h3><a href="#impl-BorrowMut%3CT%3E" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/borrow.rs.html#216-220" title="goto source code">[src]</a></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.borrow_mut" class="method trait-impl has-srclink"><h4 class="code-header">pub fn <a href="https://doc.rust-lang.org/1.54.0/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut" class="fnname">borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.54.0/std/primitive.reference.html">&amp;mut </a>T</h4><a href="#method.borrow_mut" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/borrow.rs.html#217" title="goto source code">[src]</a></div></summary><div class='docblock'><p>Mutably borrows from an owned value. <a href="https://doc.rust-lang.org/1.54.0/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-From%3CT%3E" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for T</h3><a href="#impl-From%3CT%3E" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/convert/mod.rs.html#544-548" title="goto source code">[src]</a></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.from" class="method trait-impl has-srclink"><h4 class="code-header">pub fn <a href="https://doc.rust-lang.org/1.54.0/core/convert/trait.From.html#tymethod.from" class="fnname">from</a>(t: T) -&gt; T</h4><a href="#method.from" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/convert/mod.rs.html#545" title="goto source code">[src]</a></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Into%3CU%3E" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt;,&nbsp;</span></h3><a href="#impl-Into%3CU%3E" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/convert/mod.rs.html#533-540" title="goto source code">[src]</a></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.into" class="method trait-impl has-srclink"><h4 class="code-header">pub fn <a href="https://doc.rust-lang.org/1.54.0/core/convert/trait.Into.html#tymethod.into" class="fnname">into</a>(self) -&gt; U</h4><a href="#method.into" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/convert/mod.rs.html#537" title="goto source code">[src]</a></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Same%3CT%3E" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="../typenum/type_operators/trait.Same.html" title="trait typenum::type_operators::Same">Same</a>&lt;T&gt; for T</h3><a href="#impl-Same%3CT%3E" class="anchor"></a><a class="srclink" href="../src/typenum/type_operators.rs.html#34-36" title="goto source code">[src]</a></div></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><div id="associatedtype.Output" class="type trait-impl has-srclink"><h4 class="code-header">type <a href="../typenum/type_operators/trait.Same.html#associatedtype.Output" class="type">Output</a> = T</h4><a href="#associatedtype.Output" class="anchor"></a></div></summary><div class='docblock'><p>Should always be <code>Self</code></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-TryFrom%3CU%3E" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;T&gt;,&nbsp;</span></h3><a href="#impl-TryFrom%3CU%3E" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/convert/mod.rs.html#581-590" title="goto source code">[src]</a></div></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><div id="associatedtype.Error" class="type trait-impl has-srclink"><h4 class="code-header">type <a href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html#associatedtype.Error" class="type">Error</a> = <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></h4><a href="#associatedtype.Error" class="anchor"></a></div></summary><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.try_from" class="method trait-impl has-srclink"><h4 class="code-header">pub fn <a href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html#tymethod.try_from" class="fnname">try_from</a>(value: U) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="type" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4><a href="#method.try_from" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/convert/mod.rs.html#587" title="goto source code">[src]</a></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-TryInto%3CU%3E" class="impl has-srclink"><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryInto.html" title="trait core::convert::TryInto">TryInto</a>&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;,&nbsp;</span></h3><a href="#impl-TryInto%3CU%3E" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/convert/mod.rs.html#567-576" title="goto source code">[src]</a></div></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><div id="associatedtype.Error-1" class="type trait-impl has-srclink"><h4 class="code-header">type <a href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryInto.html#associatedtype.Error" class="type">Error</a> = &lt;U as <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="type" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a></h4><a href="#associatedtype.Error-1" class="anchor"></a></div></summary><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.try_into" class="method trait-impl has-srclink"><h4 class="code-header">pub fn <a href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryInto.html#tymethod.try_into" class="fnname">try_into</a>(self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.54.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="type" href="https://doc.rust-lang.org/1.54.0/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4><a href="#method.try_into" class="anchor"></a><a class="srclink" href="https://doc.rust-lang.org/1.54.0/src/core/convert/mod.rs.html#573" title="goto source code">[src]</a></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="near_vm_logic" data-search-index-js="../search-index.js" data-search-js="../search.js"></div><script src="../main.js"></script></body></html>